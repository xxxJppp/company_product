/** layui-v2.2.45 MIT License By http://www.layui.com */layui.define("layer",function(x){var g=layui.$,y=layui.layer,z=layui.hint(),h=layui.device(),m={config:{},set:function(a){return this.config=g.extend({},this.config,a),this},on:function(a,d){return layui.onevent.call(this,l,a,d)}},A=function(){var a=this;return{upload:function(d){a.upload.call(a,d)},config:a.config}},l="upload",f=function(a){this.config=g.extend({},this.config,m.config,a);this.render()};f.prototype.config={accept:"images",exts:"",auto:!0,bindAction:"",url:"",field:"file",method:"post",data:{},drag:!0,size:0,number:0,multiple:!1};f.prototype.render=function(a){a=this.config;a.elem=g(a.elem);a.bindAction=g(a.bindAction);this.file();this.events()};f.prototype.file=function(){var a=this.config,d=this.elemFile=g(['\x3cinput class\x3d"layui-upload-file" type\x3d"file" name\x3d"'+a.field+'"',a.multiple?" multiple":"","\x3e"].join("")),f=a.elem.next();(f.hasClass("layui-upload-file")||f.hasClass("layui-upload-form"))&&f.remove();h.ie&&10>h.ie&&a.elem.wrap('\x3cdiv class\x3d"layui-upload-wrap"\x3e\x3c/div\x3e');this.isFile()?(this.elemFile=a.elem,a.field=a.elem[0].name):a.elem.after(d);h.ie&&10>h.ie&&this.initIE()};f.prototype.initIE=function(){var a=this.config,d=g('\x3ciframe id\x3d"layui-upload-iframe" class\x3d"layui-upload-iframe" name\x3d"layui-upload-iframe" frameborder\x3d"0"\x3e\x3c/iframe\x3e'),f=g(['\x3cform target\x3d"layui-upload-iframe" class\x3d"layui-upload-form" method\x3d"'+a.method,'" key\x3d"set-mine" enctype\x3d"multipart/form-data" action\x3d"'+a.url+'"\x3e',"\x3c/form\x3e"].join(""));g("#layui-upload-iframe")[0]||g("body").append(d);a.elem.next().hasClass("layui-upload-iframe")||(this.elemFile.wrap(f),a.elem.next(".layui-upload-iframe").append(function(){var c=[];return layui.each(a.data,function(a,e){c.push('\x3cinput type\x3d"hidden" name\x3d"'+a+'" value\x3d"'+e+'"\x3e')}),c.join("")}()))};f.prototype.msg=function(a){return y.msg(a,{icon:2,shift:6})};f.prototype.isFile=function(){var a=this.config.elem[0];if(a)return"input"===a.tagName.toLocaleLowerCase()&&"file"===a.type};f.prototype.preview=function(a){window.FileReader&&layui.each(this.chooseFiles,function(d,g){var c=new FileReader;c.readAsDataURL(g);c.onload=function(){a&&a(d,g,this.result)}})};f.prototype.upload=function(a,d){var u,c=this,b=c.config,e=c.elemFile[0],r=function(){var p=0,d=0,f=function(){b.multiple&&p+d===c.fileLength&&"function"==typeof b.allDone&&b.allDone({total:c.fileLength,successful:p,aborted:d})};layui.each(a||c.files||c.chooseFiles||e.files,function(a,e){var q=new FormData;q.append(b.field,e);layui.each(b.data,function(a,b){q.append(a,b)});g.ajax({url:b.url,type:b.method,data:q,contentType:!1,processData:!1,dataType:"json",success:function(b){p++;l(a,b);f()},error:function(){d++;c.msg("\u8bf7\u6c42\u4e0a\u4f20\u63a5\u53e3\u51fa\u73b0\u5f02\u5e38");v(a);f()}})})},m=function(){var a=g("#layui-upload-iframe");c.elemFile.parent().submit();clearInterval(f.timer);f.timer=setInterval(function(){var b,e=a.contents().find("body");try{b=e.text()}catch(C){c.msg("\u83b7\u53d6\u4e0a\u4f20\u540e\u7684\u54cd\u5e94\u4fe1\u606f\u51fa\u73b0\u5f02\u5e38"),clearInterval(f.timer),v()}b&&(clearInterval(f.timer),e.html(""),l(0,b))},30)},l=function(a,d){if(c.elemFile.next(".layui-upload-choose").remove(),e.value="","object"!=typeof d)try{d=JSON.parse(d)}catch(B){return d={},c.msg("\u8bf7\u5bf9\u4e0a\u4f20\u63a5\u53e3\u8fd4\u56de\u6709\u6548JSON")}"function"==typeof b.done&&b.done(d,a||0,function(a){c.upload(a)})},v=function(a){b.auto&&(e.value="");"function"==typeof b.error&&b.error(a||0,function(a){c.upload(a)})},n=b.exts,k=function(){var b=[];return layui.each(a||c.chooseFiles,function(a,c){b.push(c.name)}),b}(),w={preview:function(a){c.preview(a)},upload:function(a,b){var e={};e[a]=b;c.upload(e)},pushFile:function(){return c.files=c.files||{},layui.each(c.chooseFiles,function(a,b){c.files[a]=b}),c.files}};if(k=0===k.length?e.value.match(/[^\/\\]+\..+/g)||[]:k,0!==k.length){switch(b.accept){case "file":if(n&&!RegExp("\\w\\.("+n+")$","i").test(escape(k)))return c.msg("\u9009\u62e9\u7684\u6587\u4ef6\u4e2d\u5305\u542b\u4e0d\u652f\u6301\u7684\u683c\u5f0f"),e.value="";break;case "video":if(!RegExp("\\w\\.("+(n||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(k)))return c.msg("\u9009\u62e9\u7684\u89c6\u9891\u4e2d\u5305\u542b\u4e0d\u652f\u6301\u7684\u683c\u5f0f"),e.value="";break;case "audio":if(!RegExp("\\w\\.("+(n||"mp3|wav|mid")+")$","i").test(escape(k)))return c.msg("\u9009\u62e9\u7684\u97f3\u9891\u4e2d\u5305\u542b\u4e0d\u652f\u6301\u7684\u683c\u5f0f"),e.value="";break;default:if(layui.each(k,function(a,b){RegExp("\\w\\.("+(n||"jpg|png|gif|bmp|jpeg$")+")","i").test(escape(b))||(u=!0)}),u)return c.msg("\u9009\u62e9\u7684\u56fe\u7247\u4e2d\u5305\u542b\u4e0d\u652f\u6301\u7684\u683c\u5f0f"),e.value=""}if(c.fileLength=function(){var b=0;return layui.each(a||c.files||c.chooseFiles||e.files,function(){b++}),b}(),b.number&&c.fileLength>b.number)return c.msg("\u540c\u65f6\u6700\u591a\u53ea\u80fd\u4e0a\u4f20\u7684\u6570\u91cf\u4e3a\uff1a"+b.number);if(0<b.size&&!(h.ie&&10>h.ie)){var t;if(layui.each(c.chooseFiles,function(a,c){c.size>1024*b.size&&(a=b.size/1024,a=1<=a?Math.floor(a)+(0<a%1?a.toFixed(1):0)+"MB":b.size+"KB",e.value="",t=a)}),t)return c.msg("\u6587\u4ef6\u4e0d\u80fd\u8d85\u8fc7"+t)}"choose"===d?b.choose&&b.choose(w):(b.before&&b.before(w),h.ie?9<h.ie?r():m():r())}};f.prototype.events=function(){var a=this,d=a.config,f=function(b){a.chooseFiles={};layui.each(b,function(b,c){var e=(new Date).getTime();a.chooseFiles[e+"-"+b]=c})},c=function(b,c){c=a.elemFile;b=1<b.length?b.length+"\u4e2a\u6587\u4ef6":(b[0]||{}).name||c[0].value.match(/[^\/\\]+\..+/g)||[];c.next().hasClass("layui-upload-choose")&&c.next().remove();a.upload(null,"choose");a.isFile()||d.choose||c.after('\x3cspan class\x3d"layui-inline layui-upload-choose"\x3e'+b+"\x3c/span\x3e")};d.elem.off("upload.start").on("upload.start",function(){var b=g(this),c=b.attr("lay-data");if(c)try{c=(new Function("return "+c))(),a.config=g.extend({},d,c)}catch(r){z.error("Upload element property lay-data configuration item has a syntax error: "+c)}a.config.item=b;a.elemFile[0].click()});h.ie&&10>h.ie||d.elem.off("upload.over").on("upload.over",function(){g(this).attr("lay-over","")}).off("upload.leave").on("upload.leave",function(){g(this).removeAttr("lay-over")}).off("upload.drop").on("upload.drop",function(b,e){b=g(this);e=e.originalEvent.dataTransfer.files||[];b.removeAttr("lay-over");f(e);d.auto?a.upload(e):c(e)});a.elemFile.off("upload.change").on("upload.change",function(){var b=this.files||[];f(b);d.auto?a.upload():c(b)});d.bindAction.off("upload.action").on("upload.action",function(){a.upload()});d.elem.data("haveEvents")||(a.elemFile.on("change",function(){g(this).trigger("upload.change")}),d.elem.on("click",function(){a.isFile()||g(this).trigger("upload.start")}),d.drag&&d.elem.on("dragover",function(a){a.preventDefault();g(this).trigger("upload.over")}).on("dragleave",function(a){g(this).trigger("upload.leave")}).on("drop",function(a){a.preventDefault();g(this).trigger("upload.drop",a)}),d.bindAction.on("click",function(){g(this).trigger("upload.action")}),d.elem.data("haveEvents",!0))};m.render=function(a){a=new f(a);return A.call(a)};x(l,m)});